<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8" />
        <title>MastoScraper</title>
        <link rel="stylesheet" type="text/css" href="mastoscraper.css" />
        <script src="mastoscraper.js"></script>
    </head>

    <body>
        <div class="mastodon-logo">
            <img
                src="icons/mastoscraper-logo.svg"
                width="300"
                fill="currentColor"
            />
            <div id="version-div">v0.1</div>
        </div>
        <br />
        <!-- Authentication container -->
        <div id="auth-fold" class="fold" style="display: none">
            Authenticate with Mastodon
        </div>
        <div id="auth-unfold" class="fold" style="display: block">
            Authenticate with Mastodon
        </div>
        <div id="auth-container" style="display: none">
            <span id="instructions">Show instructions</span>
            <br />
            <div id="instructions-container" style="display: none">
                On the first use, you will have to create an application in your
                Mastodon's account developer settings. <br /><br />
                Name it MastoScraper, do not change any settings and click the
                "Submit" button at the bottom of the page. You will need the
                application ID and secret. <br /><br />
                Follow the steps below to complete authorization.<br><br>
                <strong>⚠️ Allow pop-ups when prompted.</strong>
            </div>
            <br />
            <div id="instance-container">
                <div>Enter your Mastodon instance:</div>
                <input
                    id="instance-input"
                    class="masto-scraper"
                    type="text"
                    placeholder="Enter your Mastodon instance (example.instance)"
                />
                <button id="instance-save" class="masto-scraper">Save</button>
            </div>
            <div id="id-container">
                <div>Enter your app ID:</div>
                <input
                    id="id-input"
                    class="masto-scraper"
                    type="password"
                    placeholder="Enter your app ID"
                />
                <button id="id-save" class="masto-scraper">Save</button>
            </div>
            <div id="secret-container">
                <div>Enter your app secret:</div>
                <input
                    id="secret-input"
                    class="masto-scraper"
                    type="password"
                    placeholder="Enter your app secret"
                />
                <button id="secret-save" class="masto-scraper">Save</button>
            </div>
            <button
                id="get-code-btn"
                class="masto-scraper"
                style="display: none"
            >
                Get code
            </button>
            <div id="code-container" style="display: none">
                <div>Enter your code:</div>
                <input
                    id="code-input"
                    class="masto-scraper"
                    type="password"
                    placeholder="Enter your code"
                />
                <button id="code-save" class="masto-scraper">Save</button>
            </div>
            <div id="auth-btn-container" style="display: none">
                <div>Click "Authorize", then copy the "access_token"</div>
                <button name="auth-btn" id="auth-btn" class="masto-scraper">
                    Authorize
                </button>
            </div>
            <div id="token-container" style="display: none">
                <div>Paste your access token:</div>
                <input
                    id="token-input"
                    class="masto-scraper"
                    type="password"
                    placeholder="Paste your access token"
                />
                <button id="token-save" class="masto-scraper">Save</button>
            </div>
            <div id="all-done" style="display: none">
                Authorization complete
            </div>
            <!-- Invisible authentication query forms -->
            <form id="auth-form-1" method="GET" action="">
                <input
                    id="id-auth-input"
                    name="client_id"
                    type="password"
                    style="display: none"
                />
                <input
                    id="redirect-input"
                    name="redirect_uri"
                    type="text"
                    style="display: none"
                />
                <input
                    id="restype-input"
                    name="response_type"
                    type="text"
                    style="display: none"
                />
            </form>
            <form id="auth-form-2" method="POST" action="">
                <input
                    id="id-auth-input-2"
                    name="client_id"
                    type="password"
                    style="display: none"
                />
                <input
                    id="secret-auth-input-2"
                    name="client_secret"
                    type="password"
                    style="display: none"
                />
                <input
                    id="code-auth-input"
                    name="code"
                    type="password"
                    style="display: none"
                />
                <input
                    id="redirect-input-2"
                    name="redirect_uri"
                    type="text"
                    style="display: none"
                />
                <input
                    id="granttype-input"
                    name="grant_type"
                    type="text"
                    style="display: none"
                />
            </form>
        </div>
        <!-- Search container -->
        <div id="search-fold" class="fold" style="display: block">
            Build your search query
        </div>
        <div id="search-unfold" class="fold" style="display: none">
            Build your search query
        </div>
        <div id="search-container" display="block">
            <div>
                <input
                    id="all-words"
                    class="masto-scraper"
                    name="all-words"
                    type="text"
                    placeholder="All these words"
                />
            </div>
            <div>
                <input
                    id="this-phrase"
                    class="masto-scraper"
                    name="this-phrase"
                    type="text"
                    placeholder="This exact phrase"
                />
            </div>
            <!-- <div>
                <input
                    id="any-word"
                    class="masto-scraper"
                    name="any-word"
                    type="text"
                    placeholder="Any of these words"
                />
            </div>
            <div>
                <input
                    id="no-word"
                    class="masto-scraper"
                    name="no-word"
                    type="text"
                    placeholder="None of these words"
                />
            </div> -->
            <div>
                <input
                    id="lang"
                    class="masto-scraper"
                    name="lang"
                    type="text"
                    placeholder="Language (2-letter ISO code)"
                />
                <a
                    href="https://en.wikipedia.org/wiki/List_of_ISO_639_language_codes"
                    target="_blank"
                    style="display: block"
                    >(List of ISO language codes)</a
                >
            </div>
            <div>
                <input
                    id="account"
                    class="masto-scraper"
                    name="account"
                    type="text"
                    placeholder="From this account (username@instance)"
                />
            </div>
            <!-- <div>
                <label for="from-date">From: </label>
                <input
                    id="from-date"
                    class="masto-scraper"
                    name="from-date"
                    type="date"
                    placeholder="From date"
                />
            </div>
            <div>
                <label for="to-date">To: </label>
                <input
                    id="to-date"
                    class="masto-scraper"
                    name="to-date"
                    type="date"
                    placeholder="To date"
                />
            </div> -->
            <br />
            <button id="search-btn" class="masto-scraper">Search</button>
            <div id="search-msg" style="display: none">
                <div
                    class="masto-spinner"
                    id="search-spinner"
                    style="display: inline-block"
                ></div>
                Searching...
            </div>
        </div>
        <!-- Extraction container -->
        <div id="extract-container" style="display: none">
            <div>
                <label for="output-format" style="display: inline-block"
                    >Choose output format:
                </label>
                <select
                    id="output-format"
                    class="masto-scraper"
                    name="output-format"
                    style="display: inline-block"
                >
                    <option value="xml">XML/XTZ</option>
                    <option value="txt">TXT</option>
                    <option value="csv">CSV</option>
                    <option value="json">JSON</option>
                </select>
            </div>
            <div>
                <label for="max-toots" style="display: inline-block"
                    >Max toots:
                </label>
                <input
                    name="max-toots"
                    id="max-toots"
                    class="masto-scraper"
                    type="number"
                    style="display: inline-block"
                />
            </div>
        </div>
        <br />
        <div>
            <button
                id="extract-btn"
                class="masto-scraper"
                style="display: none"
            >
                Extract
            </button>
            <button id="abort-btn" class="masto-scraper" style="display: none">
                Abort
            </button>
        </div>
        <div id="results-container" style="display: none">
            <div
                class="masto-spinner"
                id="extract-spinner"
                style="display: inline-block"
            ></div>
            <div id="results-msg" style="display: inline-block">
                Extracting...
            </div>
            <!-- Download container -->
            <div>
                <button id="dl-btn" class="masto-scraper" style="display: none">
                    Download XML
                </button>
                <button
                    id="reset-btn"
                    class="masto-scraper"
                    style="display: none"
                >
                    Reset
                </button>
                <div id="dl-result"></div>
            </div>
        </div>
    </body>
</html>
